 root/usr/share/firewall4/templates/ruleset.uc | 2 +-
 root/usr/share/ucode/fw4.uc                   | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

--- a/root/usr/share/firewall4/templates/ruleset.uc
+++ b/root/usr/share/firewall4/templates/ruleset.uc
@@ -215,6 +215,13 @@ table inet fw4 {
 
 {% if (length(flowtable_devices) > 0): %}
 	chain handle_offload {
+		{% if (fw4.default_option("offload_delay")): %}
+		ct bytes < {{ fw4.default_option("ofd_bytes") }} counter accept
+		ct packets < {{ fw4.default_option("ofd_packets") }} counter accept
+		meta l4proto {{ fw4.default_option("ofd_proto") }} counter accept
+		meta length < {{ fw4.default_option("ofd_mlenght") }} counter accept
+		ct direction original counter accept
+		{% endif %}
 		flow add @ft accept
 		accept
 	}
--- a/root/usr/share/ucode/fw4.uc
+++ b/root/usr/share/ucode/fw4.uc
@@ -1971,6 +1971,11 @@ return {
 			disable_ipv6: [ "bool", null, UNSUPPORTED ],
 			flow_offloading: [ "bool", "0" ],
 			flow_offloading_hw: [ "bool", "0" ],
+			offload_delay: [ "bool", "0" ],
+			ofd_bytes: [ "int", "1000000" ],
+			ofd_packets: [ "int", "30" ],
+			ofd_proto: [ "string", "{udp}" ],
+			ofd_mlenght: [ "int", "100" ],
 
 			auto_includes: [ "bool", "1" ]
 		});
